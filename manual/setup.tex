@c -*-texinfo-*-

@c  Copyright (c) 2018 Blake McBride
@c  All rights reserved.
@c
@c  Redistribution and use in source and binary forms, with or without
@c  modification, are permitted provided that the following conditions are
@c  met:
@c
@c  1. Redistributions of source code must retain the above copyright
@c  notice, this list of conditions and the following disclaimer.
@c
@c  2. Redistributions in binary form must reproduce the above copyright
@c  notice, this list of conditions and the following disclaimer in the
@c  documentation and/or other materials provided with the distribution.
@c
@c  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
@c  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
@c  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
@c  A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
@c  HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
@c  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
@c  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
@c  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
@c  THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
@c  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
@c  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


@chapter System Setup


@anchor{Quick-start Checklist}@section Quick-start Checklist

The following enumerates the steps necessary to get the system up and running:

@enumerate
@item
@xref{Pre-requisites}
@item
@xref{Download Kiss}
@item
@xref{Setup And Configuration}
@item
Run the server by running @code{gradle tomcatRun}
@item
You can access the server by going to @code{http://localhost:8080/Kiss}
@end enumerate

@noindent Use @code{^C} to stop the server.

@section Runtime Environments

As shipped, there are three different environments that @emph{Kiss} may
run in as follows:

@enumerate
@item
Test
@item
Development
@item 
Production
@end enumerate

The @emph{Test} environment is started with @code{gradle tomcatRun} but
is only good for a quick test to see if the system is running.  It is
neither good in a development nor production environment.

The @emph{Production} scenario is created with a single command 
(@code{gradle war}) and produces a single @code{war} file that
can be deployed.

Unfortunately, the @emph{Development} environment takes many steps to
setup.  This is largely due to the complexity and variations between
IDE's.  However, once the environment is setup, developing with
@emph{Kiss} is smooth and easy.

The @emph{Development} environment consists of two servers.  One serves
the back-end REST services, and the second serves the front-end HTML, CSS, 
and JavaScript files.  By using this method, both front-end and back-end
source files can be changed on a running system and take effect immediately
without any server reboots, re-deploys, or file copies.  (This is also
true of a production environment when the new files are put in place.)

Back-end REST services are served, debugged, and edited through the IDE.
Saving a source file is all that is needed to have it take effect.
Unfortunately, setting up IDE's to do this takes several steps and is different
for each IDE.

The front-end (HTML, CSS, and JavaScript files) are served by a simple
server supplied with the @emph{Kiss} system.  @xref{Front-end Development}.
Debugging is normally done through the browser debugger.
There is no setup, and it runs by executing a single command.

@anchor{Pre-requisites}@section Pre-requisites

You should download and install the following pre-requisites.

@enumerate
@item
Java JDK 8 from @uref{https://www.oracle.com/java/index.html}
@item
Gradle from @uref{https://gradle.org}
@item
An SQL database server (e.g.@ PostgreSQL, Microsoft SQL Server, MySQL, Oracle, SQLite)
@item
IDE (e.g.@ @uref{https://www.jetbrains.com/idea,IntelliJ}, Netbeans, eclipse)
@item
GIT source code control system
@end enumerate

The system was built and tested with JDK 8, @uref{https://www.postgresql.org,PostgreSQL}, @uref{https://www.jetbrains.com/idea,IntelliJ}, and 
@uref{http://tomcat.apache.org,tomcat}.  Other environments such as IIS, Glassfish, eclipse, should work fine but may require some configuration.

Install the above per their instructions.

With the proper plugins, all of the IDE's can import the Gradle build files.

@anchor{Download Kiss}@section Download Kiss


Kiss is located at @uref{https://github.com/kiss-web/Kiss}

It can be downloaded via the following command:

@code{git clone https://github.com/kiss-web/Kiss.git}

@section Documentation

The @emph{Kiss} documentation consists of three parts; this manual, the detailed back-end API documentation contained in the JavaDocs,
and the detailed front-end API documentation.
The JavaDocs do not come with the system, but you can generate them yourself with what is provided.  @xref{javadoc,,Creating JavaDocs}.

This manual may be created in two forms.  The first is in an HTML
form.  The system comes with this.  You can also generate a nicely
formatted PDF file with the following commands (if you have all of the tools installed):

@example
cd manual
make Kiss.pdf
@end example

@noindent
Updated to the HTML file are achieved with the following commands:
@example
cd manual
make
@end example

All of the documentation can be accessed with your browser.  For example,
if the root of @emph{Kiss} is located at @code{/my/home/path/kiss} then you will be able to access the three
manuals at the following URL's:

@example
file:///my/home/path/kiss/manual/man/index.html

file:///my/home/path/kiss/build/docs/javadoc/index.html

file:///my/home/path/kiss/manual/jsdoc/index.html
@end example

@anchor{Setup And Configuration}@section Setup And Configuration

Given that Kiss is for business applications, it authenticates its
users.  In order for this to work, there is usually a database of valid
users.  This information is persisted in an SQL database.  Therefore a
database is normally required.  However, for testing purposes, if no
database is configured, the system will still run and allow any
username and password to succeed.

As shipped, the system comes configured as follows:

@multitable {Database user password} {PostgreSQL} 
@item Database type
@tab PostgreSQL
@item Host
@tab localhost
@item Database
@tab not configured
@item Database user
@tab postgres
@item Database user password
@tab postgres
@end multitable

This can be configured in the file @code{src/main/application/KissInit.groovy}
Valid options for the Database type are as follows:

@itemize @bullet
@item
PostgreSQL
@item
MicrosoftServer
@item
MySQL
@item
Oracle
@item
SQLite
@end itemize

Support for other databases is easy to add.

The remaining parameters should be self-explanatory.  Use the format
shown in the example.

Create the database (named ``kiss'' above or whatever name you
configured).  After that, you can run the script file @code{init.sql}
to create the table and some initial data.

The default username is @emph{kiss}, and the default password is
@emph{password}

Changes to  @code{KissInit.groovy} require a server reboot.

@section Building The System

The system may be built in several way.  It can be build from the
command line using @emph{Gradle}, or it can be build from within your
favorite IDE.  Using an IDE has the great advantage of a built-in
debugger.  This section will outline usage of some of these scenarios.

@subsection Gradle 

While not the best choice when in development mode, @emph{Gradle} is a
good choice when generating the JavaDocs and possibly also when
generating the final @emph{WAR} file.  @emph{Gradle} may be used as follows:
(Note, this is not a list of command you should run in order to get the system running.  
@xref{Quick-start Checklist}.

@table @code
@item gradle javadoc
JavaDocs end up in the @code{build/docs/javadoc} directory.
@item gradle war
The WAR file ends up in the @code{build/libs} directory.  
This file can be just placed in the webapps directory of tomcat to deploy.
@item gradle explodedWar
This builds a set of files that would have been placed in the deployment WAR file.  It is used, when needed,
to run the entire system from a local directory.  The files are placed in the @code{build/exploded/kiss}
directory.
@item gradle clean
Removes all the generated files.
@item gradle tomcatRun
Runs a sample server serving up the application.  The system will be
available from your local browser at
@code{http://localhost:8080/Kiss}.  Use @code{^C} to exit.
(Note two things about this.  First, this will not run unless you created the database described in the previous section.
Also, although @code{gradle tomcatRun} is nice to do a quick check, this is neither an apt development environment nor
an apt production environment.  It is simply good as a quick check.  The following sections detail apt development and production environments.)  
@end table

@subsection IntelliJ Ultimate

IntelliJ is a good IDE.  The free version may be inadequate for
@emph{Kiss} however.  IntelliJ should be configured with support for
@code{Gradle}, @code{tomcat}, and @code{Groovy}.  You may set it up as follows:

@enumerate
@item
Get a fresh clone
@item
If you just entered IntelliJ select @code{Import Project}, 
or if already in a project select @code{New} / @code{Project}
from existing source.
@item
Select the file @emph{build.gradle}
@item
Accept all defaults
@item
Go to Run / Edit Configurations
@item
Click the ``+'' in the upper left corner
@item
Select @emph{Tomcat Server} / @emph{Local}
@item
Change the Name to Kiss
@item
Click the Deployment tab
@item
Click the ``+'' in the upper right quadrant of the screen (not the upper left)
@item
Select @emph{Artifact} and then @emph{Kiss.war} (exploded)
@item
Click "OK"
@item
Right-click the @code{application} directory in the @emph{Project} window.
Select @emph{Mark Directory as} and then @emph{Sources Root}.
@end enumerate

To run the app in debug mode just click the green bug at the top of the screen.  This will run the front-end and back-end 
in a debug mode.  Although this is the recommended setup for the back-end portion during development, it is not recommended
for front-end development.  In order to do front-end and back-end development at the same time, a dual server setup where
the front-end and back-end are served by different servers is recommended.  

@subsection NetBeans, eclipse, etc.

Other IDE's that can import @emph{gradle} projects should run equally well.  More detailed instruction will follow.

@section What Do I Do With It Now?

What you have at this point is the beginnings of your new application.
@emph{Kiss} is provided as a running and deployable system.  It is
expected that you would modify what's here to suit your application
needs.

Besides this narrative, you would need the JavaDocs located under the
@code{build/docs/javadoc} directory for API specific documentation.
(Which you must generate via @emph{Gradle} as described. @xref{javadoc,,Creating JavaDocs}.
