<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>DateTimeUtils.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AGGrid.html">AGGrid</a><ul class='methods'><li data-type='method'><a href="AGGrid.html#.addGrid">addGrid</a></li><li data-type='method'><a href="AGGrid.html#.date">date</a></li><li data-type='method'><a href="AGGrid.html#.dateTime">dateTime</a></li><li data-type='method'><a href="AGGrid.html#.newGridContext">newGridContext</a></li><li data-type='method'><a href="AGGrid.html#.numericFormat">numericFormat</a></li><li data-type='method'><a href="AGGrid.html#.popAllGridContexts">popAllGridContexts</a></li><li data-type='method'><a href="AGGrid.html#.popGridContext">popGridContext</a></li><li data-type='method'><a href="AGGrid.html#.time">time</a></li><li data-type='method'><a href="AGGrid.html#addComponent">addComponent</a></li><li data-type='method'><a href="AGGrid.html#addRecord">addRecord</a></li><li data-type='method'><a href="AGGrid.html#addRecords">addRecords</a></li><li data-type='method'><a href="AGGrid.html#clear">clear</a></li><li data-type='method'><a href="AGGrid.html#clearSelection">clearSelection</a></li><li data-type='method'><a href="AGGrid.html#columnShow">columnShow</a></li><li data-type='method'><a href="AGGrid.html#deleteRow">deleteRow</a></li><li data-type='method'><a href="AGGrid.html#deleteRowIndex">deleteRowIndex</a></li><li data-type='method'><a href="AGGrid.html#deleteSelectedRows">deleteSelectedRows</a></li><li data-type='method'><a href="AGGrid.html#deselectAll">deselectAll</a></li><li data-type='method'><a href="AGGrid.html#destroy">destroy</a></li><li data-type='method'><a href="AGGrid.html#disable">disable</a></li><li data-type='method'><a href="AGGrid.html#enable">enable</a></li><li data-type='method'><a href="AGGrid.html#getAllRows">getAllRows</a></li><li data-type='method'><a href="AGGrid.html#getFirstRow">getFirstRow</a></li><li data-type='method'><a href="AGGrid.html#getLastRow">getLastRow</a></li><li data-type='method'><a href="AGGrid.html#getNumberOfRows">getNumberOfRows</a></li><li data-type='method'><a href="AGGrid.html#getRowAtIndex">getRowAtIndex</a></li><li data-type='method'><a href="AGGrid.html#getSelectedRow">getSelectedRow</a></li><li data-type='method'><a href="AGGrid.html#getSelectedRowIndex">getSelectedRowIndex</a></li><li data-type='method'><a href="AGGrid.html#getSelectedRowIndexes">getSelectedRowIndexes</a></li><li data-type='method'><a href="AGGrid.html#getSelectedRows">getSelectedRows</a></li><li data-type='method'><a href="AGGrid.html#highlightRows">highlightRows</a></li><li data-type='method'><a href="AGGrid.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="AGGrid.html#multiSelect">multiSelect</a></li><li data-type='method'><a href="AGGrid.html#noRowSelection">noRowSelection</a></li><li data-type='method'><a href="AGGrid.html#numberOfSelectedRows">numberOfSelectedRows</a></li><li data-type='method'><a href="AGGrid.html#rowStyleFunction">rowStyleFunction</a></li><li data-type='method'><a href="AGGrid.html#selectId">selectId</a></li><li data-type='method'><a href="AGGrid.html#setDragFunction">setDragFunction</a></li><li data-type='method'><a href="AGGrid.html#setOnRowDoubleClicked">setOnRowDoubleClicked</a></li><li data-type='method'><a href="AGGrid.html#setOnSelectionChanged">setOnSelectionChanged</a></li><li data-type='method'><a href="AGGrid.html#show">show</a></li><li data-type='method'><a href="AGGrid.html#updateSelectedRecord">updateSelectedRecord</a></li></ul></li><li><a href="components.html">components</a><ul class='methods'><li data-type='method'><a href="components.html#.check_box">check_box</a></li><li data-type='method'><a href="components.html#.date_input">date_input</a></li><li data-type='method'><a href="components.html#.drop_down">drop_down</a></li><li data-type='method'><a href="components.html#.file_upload">file_upload</a></li><li data-type='method'><a href="components.html#.list_box">list_box</a></li><li data-type='method'><a href="components.html#.native_date_input">native_date_input</a></li><li data-type='method'><a href="components.html#.numeric_input">numeric_input</a></li><li data-type='method'><a href="components.html#.picture">picture</a></li><li data-type='method'><a href="components.html#.popup">popup</a></li><li data-type='method'><a href="components.html#.push_button">push_button</a></li><li data-type='method'><a href="components.html#.radio_button">radio_button</a></li><li data-type='method'><a href="components.html#.text_input">text_input</a></li><li data-type='method'><a href="components.html#.text_label">text_label</a></li><li data-type='method'><a href="components.html#.textbox_input">textbox_input</a></li><li data-type='method'><a href="components.html#.time_input">time_input</a></li></ul></li><li><a href="DateTimeUtils.html">DateTimeUtils</a><ul class='methods'><li data-type='method'><a href="DateTimeUtils.html#.addHours">addHours</a></li><li data-type='method'><a href="DateTimeUtils.html#.addMinutes">addMinutes</a></li><li data-type='method'><a href="DateTimeUtils.html#.createDate">createDate</a></li><li data-type='method'><a href="DateTimeUtils.html#.dateToStd">dateToStd</a></li><li data-type='method'><a href="DateTimeUtils.html#.formatDate">formatDate</a></li><li data-type='method'><a href="DateTimeUtils.html#.formatDateLong">formatDateLong</a></li><li data-type='method'><a href="DateTimeUtils.html#.formatDateTime">formatDateTime</a></li><li data-type='method'><a href="DateTimeUtils.html#.getLocalTimezoneLongText">getLocalTimezoneLongText</a></li><li data-type='method'><a href="DateTimeUtils.html#.getLocalTimezoneShortText">getLocalTimezoneShortText</a></li><li data-type='method'><a href="DateTimeUtils.html#.stdToDate">stdToDate</a></li><li data-type='method'><a href="DateTimeUtils.html#.toIntDate">toIntDate</a></li><li data-type='method'><a href="DateTimeUtils.html#.toIntTime">toIntTime</a></li><li data-type='method'><a href="DateTimeUtils.html#.toMilliseconds">toMilliseconds</a></li></ul></li><li><a href="DateUtils.html">DateUtils</a><ul class='methods'><li data-type='method'><a href="DateUtils.html#.calendar">calendar</a></li><li data-type='method'><a href="DateUtils.html#.dateAddDays">dateAddDays</a></li><li data-type='method'><a href="DateUtils.html#.dateToInt">dateToInt</a></li><li data-type='method'><a href="DateUtils.html#.day">day</a></li><li data-type='method'><a href="DateUtils.html#.dayOfWeek">dayOfWeek</a></li><li data-type='method'><a href="DateUtils.html#.dayOfWeekName">dayOfWeekName</a></li><li data-type='method'><a href="DateUtils.html#.daysDifference">daysDifference</a></li><li data-type='method'><a href="DateUtils.html#.detectDateFormat">detectDateFormat</a></li><li data-type='method'><a href="DateUtils.html#.intAddDays">intAddDays</a></li><li data-type='method'><a href="DateUtils.html#.intToDate">intToDate</a></li><li data-type='method'><a href="DateUtils.html#.intToSQL">intToSQL</a></li><li data-type='method'><a href="DateUtils.html#.intToStr2">intToStr2</a></li><li data-type='method'><a href="DateUtils.html#.intToStr4">intToStr4</a></li><li data-type='method'><a href="DateUtils.html#.isSQLDate">isSQLDate</a></li><li data-type='method'><a href="DateUtils.html#.isValid">isValid</a></li><li data-type='method'><a href="DateUtils.html#.julian">julian</a></li><li data-type='method'><a href="DateUtils.html#.longFormat">longFormat</a></li><li data-type='method'><a href="DateUtils.html#.millsToInt">millsToInt</a></li><li data-type='method'><a href="DateUtils.html#.month">month</a></li><li data-type='method'><a href="DateUtils.html#.monthName">monthName</a></li><li data-type='method'><a href="DateUtils.html#.monthsDifference">monthsDifference</a></li><li data-type='method'><a href="DateUtils.html#.SQLtoInt">SQLtoInt</a></li><li data-type='method'><a href="DateUtils.html#.strToInt">strToInt</a></li><li data-type='method'><a href="DateUtils.html#.today">today</a></li><li data-type='method'><a href="DateUtils.html#.toInt">toInt</a></li><li data-type='method'><a href="DateUtils.html#.year">year</a></li></ul></li><li><a href="Editor.html">Editor</a><ul class='methods'><li data-type='method'><a href="Editor.html#.addEditor">addEditor</a></li><li data-type='method'><a href="Editor.html#.create">create</a></li><li data-type='method'><a href="Editor.html#.newEditorContext">newEditorContext</a></li><li data-type='method'><a href="Editor.html#.popAllEditorContexts">popAllEditorContexts</a></li><li data-type='method'><a href="Editor.html#.popEditorContext">popEditorContext</a></li><li data-type='method'><a href="Editor.html#clear">clear</a></li><li data-type='method'><a href="Editor.html#dispose">dispose</a></li><li data-type='method'><a href="Editor.html#getHtml">getHtml</a></li><li data-type='method'><a href="Editor.html#getText">getText</a></li><li data-type='method'><a href="Editor.html#printEditorContent">printEditorContent</a></li><li data-type='method'><a href="Editor.html#readOnly">readOnly</a></li><li data-type='method'><a href="Editor.html#readWrite">readWrite</a></li><li data-type='method'><a href="Editor.html#setHtml">setHtml</a></li></ul></li><li><a href="MutableString.html">MutableString</a><ul class='methods'><li data-type='method'><a href="MutableString.html#append">append</a></li><li data-type='method'><a href="MutableString.html#charAt">charAt</a></li><li data-type='method'><a href="MutableString.html#clear">clear</a></li><li data-type='method'><a href="MutableString.html#delete">delete</a></li><li data-type='method'><a href="MutableString.html#insert">insert</a></li><li data-type='method'><a href="MutableString.html#length">length</a></li><li data-type='method'><a href="MutableString.html#prepend">prepend</a></li><li data-type='method'><a href="MutableString.html#removeFromEnd">removeFromEnd</a></li><li data-type='method'><a href="MutableString.html#removeFromStart">removeFromStart</a></li><li data-type='method'><a href="MutableString.html#replace">replace</a></li><li data-type='method'><a href="MutableString.html#setCharAt">setCharAt</a></li><li data-type='method'><a href="MutableString.html#toString">toString</a></li></ul></li><li><a href="NumberUtils.html">NumberUtils</a><ul class='methods'><li data-type='method'><a href="NumberUtils.html#.floatEqual">floatEqual</a></li><li data-type='method'><a href="NumberUtils.html#.round">round</a></li><li data-type='method'><a href="NumberUtils.html#.roundDown">roundDown</a></li><li data-type='method'><a href="NumberUtils.html#.roundUp">roundUp</a></li></ul></li><li><a href="Server.html">Server</a><ul class='methods'><li data-type='method'><a href="Server.html#.binaryCall">binaryCall</a></li><li data-type='method'><a href="Server.html#.call">call</a></li><li data-type='method'><a href="Server.html#.callAll">callAll</a></li><li data-type='method'><a href="Server.html#.fileUploadSend">fileUploadSend</a></li><li data-type='method'><a href="Server.html#.logout">logout</a></li><li data-type='method'><a href="Server.html#.setMaxInactivityHours">setMaxInactivityHours</a></li><li data-type='method'><a href="Server.html#.setMaxInactivityMinutes">setMaxInactivityMinutes</a></li><li data-type='method'><a href="Server.html#.setMaxInactivitySeconds">setMaxInactivitySeconds</a></li><li data-type='method'><a href="Server.html#.setURL">setURL</a></li></ul></li><li><a href="TimeUtils.html">TimeUtils</a><ul class='methods'><li data-type='method'><a href="TimeUtils.html#.addHours">addHours</a></li><li data-type='method'><a href="TimeUtils.html#.addMinutes">addMinutes</a></li><li data-type='method'><a href="TimeUtils.html#.current">current</a></li><li data-type='method'><a href="TimeUtils.html#.dateToTime">dateToTime</a></li><li data-type='method'><a href="TimeUtils.html#.diff">diff</a></li><li data-type='method'><a href="TimeUtils.html#.format">format</a></li><li data-type='method'><a href="TimeUtils.html#.formatLong">formatLong</a></li><li data-type='method'><a href="TimeUtils.html#.hours">hours</a></li><li data-type='method'><a href="TimeUtils.html#.isValid">isValid</a></li><li data-type='method'><a href="TimeUtils.html#.millsToInt">millsToInt</a></li><li data-type='method'><a href="TimeUtils.html#.minutes">minutes</a></li><li data-type='method'><a href="TimeUtils.html#.minutesToTime">minutesToTime</a></li><li data-type='method'><a href="TimeUtils.html#.strToInt">strToInt</a></li><li data-type='method'><a href="TimeUtils.html#.totalMinutes">totalMinutes</a></li></ul></li><li><a href="Utils.html">Utils</a><ul class='methods'><li data-type='method'><a href="Utils.html#.appendChild">appendChild</a></li><li data-type='method'><a href="Utils.html#.assureArray">assureArray</a></li><li data-type='method'><a href="Utils.html#.beep">beep</a></li><li data-type='method'><a href="Utils.html#.cleanup">cleanup</a></li><li data-type='method'><a href="Utils.html#.clearAllEnterContexts">clearAllEnterContexts</a></li><li data-type='method'><a href="Utils.html#.clearSomeControlValueChanged">clearSomeControlValueChanged</a></li><li data-type='method'><a href="Utils.html#.cloneArrayShallow">cloneArrayShallow</a></li><li data-type='method'><a href="Utils.html#.convertToArray">convertToArray</a></li><li data-type='method'><a href="Utils.html#.countProperties">countProperties</a></li><li data-type='method'><a href="Utils.html#.didSomeControlValueChange">didSomeControlValueChange</a></li><li data-type='method'><a href="Utils.html#.drop">drop</a></li><li data-type='method'><a href="Utils.html#.eraseChildren">eraseChildren</a></li><li data-type='method'><a href="Utils.html#.fileNameExtension">fileNameExtension</a></li><li data-type='method'><a href="Utils.html#.fixCapitalization">fixCapitalization</a></li><li data-type='method'><a href="Utils.html#.format">format</a></li><li data-type='method'><a href="Utils.html#.formatb">formatb</a></li><li data-type='method'><a href="Utils.html#.formatSsn">formatSsn</a></li><li data-type='method'><a href="Utils.html#.getAndEraseData">getAndEraseData</a></li><li data-type='method'><a href="Utils.html#.getAppUrl">getAppUrl</a></li><li data-type='method'><a href="Utils.html#.getData">getData</a></li><li data-type='method'><a href="Utils.html#.getEmailFromAddressWithName">getEmailFromAddressWithName</a></li><li data-type='method'><a href="Utils.html#.getFileUploadCount">getFileUploadCount</a></li><li data-type='method'><a href="Utils.html#.getFileUploadFormData">getFileUploadFormData</a></li><li data-type='method'><a href="Utils.html#.getLastError">getLastError</a></li><li data-type='method'><a href="Utils.html#.getLastErrorDate">getLastErrorDate</a></li><li data-type='method'><a href="Utils.html#.getLocation">getLocation</a></li><li data-type='method'><a href="Utils.html#.getMilliseconds">getMilliseconds</a></li><li data-type='method'><a href="Utils.html#.getNameFromAddressWithName">getNameFromAddressWithName</a></li><li data-type='method'><a href="Utils.html#.getPageArgv">getPageArgv</a></li><li data-type='method'><a href="Utils.html#.getPageRetv">getPageRetv</a></li><li data-type='method'><a href="Utils.html#.getURLParam">getURLParam</a></li><li data-type='method'><a href="Utils.html#.globalEnterHandler">globalEnterHandler</a></li><li data-type='method'><a href="Utils.html#.htmlToText">htmlToText</a></li><li data-type='method'><a href="Utils.html#.isChangeChar">isChangeChar</a></li><li data-type='method'><a href="Utils.html#.isOnline">isOnline</a></li><li data-type='method'><a href="Utils.html#.isValidDomain">isValidDomain</a></li><li data-type='method'><a href="Utils.html#.isValidEmailAddress">isValidEmailAddress</a></li><li data-type='method'><a href="Utils.html#.isValidEmailAddressWithName">isValidEmailAddressWithName</a></li><li data-type='method'><a href="Utils.html#.isValidSsn">isValidSsn</a></li><li data-type='method'><a href="Utils.html#.keep">keep</a></li><li data-type='method'><a href="Utils.html#.loadPage">loadPage</a></li><li data-type='method'><a href="Utils.html#.makeDraggable">makeDraggable</a></li><li data-type='method'><a href="Utils.html#.newEnterContext">newEnterContext</a></li><li data-type='method'><a href="Utils.html#.popEnterContext">popEnterContext</a></li><li data-type='method'><a href="Utils.html#.popPage">popPage</a></li><li data-type='method'><a href="Utils.html#.popup_close">popup_close</a></li><li data-type='method'><a href="Utils.html#.popup_open">popup_open</a></li><li data-type='method'><a href="Utils.html#.popup_set_height">popup_set_height</a></li><li data-type='method'><a href="Utils.html#.popup_set_width">popup_set_width</a></li><li data-type='method'><a href="Utils.html#.pushPage">pushPage</a></li><li data-type='method'><a href="Utils.html#.rescan">rescan</a></li><li data-type='method'><a href="Utils.html#.saveData">saveData</a></li><li data-type='method'><a href="Utils.html#.setEnterFunction">setEnterFunction</a></li><li data-type='method'><a href="Utils.html#.setSomeControlValueChangeFunction">setSomeControlValueChangeFunction</a></li><li data-type='method'><a href="Utils.html#.showMessage">showMessage</a></li><li data-type='method'><a href="Utils.html#.showReport">showReport</a></li><li data-type='method'><a href="Utils.html#.someControlValueChanged">someControlValueChanged</a></li><li data-type='method'><a href="Utils.html#.splitEmailAddresses">splitEmailAddresses</a></li><li data-type='method'><a href="Utils.html#.take">take</a></li><li data-type='method'><a href="Utils.html#.textToHtml">textToHtml</a></li><li data-type='method'><a href="Utils.html#.toASCII">toASCII</a></li><li data-type='method'><a href="Utils.html#.toBase64">toBase64</a></li><li data-type='method'><a href="Utils.html#.toggleFullscreen">toggleFullscreen</a></li><li data-type='method'><a href="Utils.html#.toNumber">toNumber</a></li><li data-type='method'><a href="Utils.html#.useComponent">useComponent</a></li><li data-type='method'><a href="Utils.html#.useTaglessComponent">useTaglessComponent</a></li><li data-type='method'><a href="Utils.html#.uuid">uuid</a></li><li data-type='method'><a href="Utils.html#.waitMessage">waitMessage</a></li><li data-type='method'><a href="Utils.html#.waitMessageEnd">waitMessageEnd</a></li><li data-type='method'><a href="Utils.html#.yesNo">yesNo</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#$$">$$</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">DateTimeUtils.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* global DateUtils, TimeUtils */

/**
 * Created by Blake McBride on 6/16/18.
 */

'use strict';


/**
 * Class to deal with dates and times together.
 *
 */
class DateTimeUtils {

    /**
     * Format a moment as "Wed Jan 4, 2022 12:31 PM CST".
     *
     * @param {Date|number|string} dt – Date object, epoch-millis, or numeric string
     * @param {string}            [tz] – IANA zone name (e.g. "America/Chicago");
     *                                   omit/falsy → host’s local zone
     * @returns {string}
     */
    static formatDateLong(dt, tz) {
        /* ---------- normalise input ---------- */
        if (typeof dt === 'string') {
            dt = dt.trim();
            if (!dt)
                return '';
            dt = Number(dt);
        }
        if (typeof dt === 'number')
            dt = new Date(dt);
        if (!(dt instanceof Date) || isNaN(dt))
            return '';

        /* ---------- obtain the pieces we need ---------- */
        const opts = {
            timeZone     : tz || undefined,   // undefined ⇒ keep local zone
            weekday      : 'short',           // Wed
            month        : 'short',           // Jan
            day          : 'numeric',         // 4
            year         : 'numeric',         // 2022
            hour         : 'numeric',         // 12  (no leading zero)
            minute       : '2-digit',         // 31
            hour12       : true,              // AM/PM
            timeZoneName : 'short'            // CST
        };

        const parts = new Intl.DateTimeFormat('en-US', opts).formatToParts(dt);
        const get   = type => parts.find(p => p.type === type)?.value || '';

        /* ---------- assemble in the desired order ---------- */
        return `${get('weekday')} ${get('month')} ${get('day')}, ${get('year')} `
            + `${get('hour')}:${get('minute')} ${get('dayPeriod')} ${get('timeZoneName')}`;
    }

    /**
     * Convert a Date into the canonical interchange string
     *   yyyy-MM-dd HH:mm:ss &lt;offset-in-minutes>
     *
     * @param {Date|number|string} dt   – Date object, millis, or numeric string
     * @param {string}            [tz]  – IANA zone name (e.g. "America/New_York");
     *                                    omit/falsy ⇒ use the host’s local zone
     * @returns {string}
     */
    static dateToStd(dt, tz) {
        /* ---------- normalise input ---------- */
        if (typeof dt === 'string') {
            dt = dt.trim();
            if (!dt) return '';
            dt = Number(dt);
        }
        if (typeof dt === 'number') dt = new Date(dt);
        if (!(dt instanceof Date) || isNaN(dt)) return '';

        /* ---------- Y-M-D H:m:s parts in the target zone ---------- */
        const fmt = new Intl.DateTimeFormat('en-CA', {
            timeZone : tz || undefined,   // undefined ⇒ local zone
            year     : 'numeric',
            month    : '2-digit',
            day      : '2-digit',
            hour     : '2-digit',
            minute   : '2-digit',
            second   : '2-digit',
            hour12   : false
        }).formatToParts(dt);

        const pick = t => fmt.find(p => p.type === t).value;
        const YYYY = pick('year'),
            MM   = pick('month'),
            DD   = pick('day'),
            HH   = pick('hour'),
            mm   = pick('minute'),
            ss   = pick('second');

        /* ---------- offset in **integer** minutes ---------- */
        let offsetMinutes;

        if (!tz) {
            offsetMinutes = dt.getTimezoneOffset();           // already an int
        } else {
            const fakeUTC = Date.UTC(
                Number(YYYY), Number(MM) - 1, Number(DD),
                Number(HH),  Number(mm),     Number(ss)
            );
            // Round to ensure we never emit a fraction like 240.0000001
            offsetMinutes = Math.round((dt.getTime() - fakeUTC) / 60000);
        }

        /* ---------- final string ---------- */
        return `${YYYY}-${MM}-${DD} ${HH}:${mm}:${ss} ${offsetMinutes}`;
    }

    /**
     * Parse a standard string date format into a Date object.
     * Expected standard date format looks like this:  2022-06-08 03:27:44 300
     * The 300 is minutes offset from GMT - the timezone
     * This routine parses a date from any timezone and returns a Date object in the local timezone.
     *
     * @param sdt {string}
     * @returns {Date}
     */
    static stdToDate(sdt) {
        if (typeof sdt !== 'string' || !sdt)
            return null;
        if (!/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2} -?\d{1,3}$/.test(sdt))
            return null;
        const y = Number(sdt.slice(0, 4));
        const month = Number(sdt.slice(5, 7));
        const d = Number(sdt.slice(8, 10));
        const h = Number(sdt.slice(11, 13));
        const minutes = Number(sdt.slice(14, 16));
        const s = Number(sdt.slice(17, 19));
        const tz1 = Number(sdt.slice(20)); // replaces Utils.drop(sdt, 20)
        const dt = new Date(y, month - 1, d, h, minutes, s);
        const tz2 = dt.getTimezoneOffset();
        return new Date(dt.valueOf() - tz2 * 60000 + tz1 * 60000);
    }

    /**
     * Convert in integer date and integer time into a Date object.
     *
     * @param dt YYYYMMDD
     * @param tm  HHMM
     * @returns {Date}
     */
    static createDate(dt, tm) {
        if (!dt)
            return null;
        const y = Math.floor(dt / 10000);
        dt -= y * 10000;
        const m = Math.floor(dt / 100);
        const d = Math.floor(dt - m * 100);
        const h = Math.floor(tm / 100);
        const min = tm - Math.floor(tm / 100) * 100;
        return new Date(y, m - 1, d, h, min);
    }

    /**
     * Format a Date or milliseconds-since-epoch value to a string
     * "mm/dd/yyyy hh:mm AM/PM"  or  "dd/mm/yyyy hh:mm AM/PM"
     *
     * @param {Date|string|number} dt        – Date object, millis, or numeric string
     * @param {string}             [tz]      – IANA zone (e.g. "America/New_York");
     *                                         omit or pass falsy to use the local zone
     * @returns {string}
     */
    static formatDate(dt, tz) {
        // ----- normalise the first argument -----
        if (typeof dt === 'string') {
            dt = dt.trim();
            if (!dt || dt === '0')
                return '';
            dt = Number(dt);
        }
        if (typeof dt === 'number') {            // millis
            if (!dt)
                return '';
            dt = new Date(dt);
        }
        if (!(dt instanceof Date) || isNaN(dt))
            return '';

        // ----- build the parts for the requested (or local) time-zone -----
        const parts = new Intl.DateTimeFormat(
            undefined,                           // keep user’s locale
            {
                timeZone : tz || undefined,      // undefined → local zone
                year     : 'numeric',
                month    : 'numeric',
                day      : 'numeric',
                hour     : 'numeric',            // already 1-12 in hour12 mode
                minute   : '2-digit',
                hour12   : true
            }
        ).formatToParts(dt);

        // quick helper to pull the values we need
        const pick = type => parts.find(p => p.type === type)?.value;

        const month   = pick('month');   // "1" … "12"
        const day     = pick('day');
        const year    = pick('year');
        const hour    = pick('hour');    // "1" … "12"
        const minute  = pick('minute');  // always 2-digit because of '2-digit'
        const ampm    = pick('dayPeriod'); // "AM" / "PM"

        // ----- honour your existing MM/DD vs DD/MM preference -----
        const mdy = DateUtils.detectDateFormat() === 'MM/DD/YYYY';
        const dateStr = mdy
            ? `${month}/${day}/${year}`
            : `${day}/${month}/${year}`;

        return `${dateStr} ${hour}:${minute} ${ampm}`;
    }

    /**
     * Format a date (YYYYMMDD) and a time (HHMM) as
     *   "mm/dd/yyyy hh:mm AM/PM"  or  "dd/mm/yyyy hh:mm AM/PM"
     *
     * @param {number|string} dt     – calendar date, e.g. 20250508
     * @param {number|string} time   – clock time,   e.g. 1145
     * @param {string}        [tz]   – IANA zone name; omit/falsy ⇒ host’s zone
     * @returns {string}
     */
    static formatDateTime(dt, time, tz) {

        /* ---------- trivial short-circuit ---------- */
        if (!dt &amp;&amp; (time === undefined || time === null || time === ''))
            return '';

        /* ---------- normalise inputs ---------- */
        if (typeof dt   === 'string') dt   = Number(dt);
        if (typeof time === 'string') time = Number(time);

        if (isNaN(dt)  || dt &lt;= 0)   return '';
        if (isNaN(time) || time &lt; 0) time = 0;

        /* split YYYYMMDD */
        const y  = Math.floor(dt / 10000);
        const m  = Math.floor((dt % 10000) / 100) - 1;   // JS month 0–11
        const d  = dt % 100;

        /* split HHMM */
        const h  = Math.floor(time / 100);
        const mi = time % 100;

        /* ---------- build Date in the **local** zone ---------- */
        const date = new Date(y, m, d, h, mi);

        /* ---------- format in the target (or local) zone ---------- */
        const parts = new Intl.DateTimeFormat(undefined, {
            timeZone : tz || undefined,   // undefined ⇒ keep host’s zone
            year     : 'numeric',
            month    : 'numeric',
            day      : 'numeric',
            hour     : 'numeric',
            minute   : '2-digit',
            hour12   : true
        }).formatToParts(date);

        const get = t => parts.find(p => p.type === t)?.value;
        const MM  = get('month');
        const DD  = get('day');
        const YYYY= get('year');
        const HH  = get('hour');
        const MMm = get('minute');
        const AP  = get('dayPeriod');

        /* honour the user’s MM/DD vs DD/MM preference */
        const mdy  = DateUtils.detectDateFormat?.() === 'MM/DD/YYYY';
        const dateStr = mdy ? `${MM}/${DD}/${YYYY}` : `${DD}/${MM}/${YYYY}`;

        return `${dateStr} ${HH}:${MMm} ${AP}`;
    }

    /**
     * Convert a moment in time to an integer clock value (HHMM).
     * The date portion is ignored.
     *
     * @param {Date|number} dt          – Date instance **or** milliseconds-since-epoch
     * @param {string}      [zoneId]    – optional IANA time-zone (e.g. "America/New_York");
     *                                    omit or falsy → use the host’s local zone
     * @returns {number}                – integer HHMM, or NaN on bad input
     */
    static toIntTime(dt, zoneId) {
        // ---------- normalise the input ----------
        if (typeof dt === 'number') dt = new Date(dt);
        if (!(dt instanceof Date) || isNaN(dt)) return NaN;

        let hours, minutes;

        if (zoneId) {
            // Use Intl to obtain the clock reading in the requested zone
            const parts = new Intl.DateTimeFormat('en-US', {
                timeZone : zoneId,
                hour     : '2-digit',
                minute   : '2-digit',
                hour12   : false          // 00-23
            }).formatToParts(dt);

            hours   = Number(parts.find(p => p.type === 'hour').value);
            minutes = Number(parts.find(p => p.type === 'minute').value);
        } else {
            // Original behaviour: host computer’s local zone
            hours   = dt.getHours();
            minutes = dt.getMinutes();
        }

        return hours * 100 + minutes;     // e.g. 14 h 07 m → 1407
    }

    /**
     * Extract the calendar date as an integer (YYYYMMDD).
     *
     * @param {Date|number} dt        – Date object *or* milliseconds since epoch.
     * @param {string}      [zoneId]  – optional IANA time-zone, e.g. "America/New_York".
     *                                  Omit/falsy ⇒ use the host’s local zone.
     * @returns {number}              – YYYYMMDD, or NaN on invalid input.
     */
    static toIntDate(dt, zoneId) {
        // ---- normalise the first argument ----
        if (typeof dt === 'number') dt = new Date(dt);
        if (!(dt instanceof Date) || isNaN(dt)) return NaN;

        let year, month, day;

        if (zoneId) {
            // Use Intl to get y-m-d as seen in the requested zone
            const parts = new Intl.DateTimeFormat('en-CA', { // fixed ISO-like order
                timeZone : zoneId,
                year  : 'numeric',
                month : '2-digit',
                day   : '2-digit'
            }).formatToParts(dt);

            const pick = t => parts.find(p => p.type === t).value;
            year  = Number(pick('year'));
            month = Number(pick('month'));
            day   = Number(pick('day'));
        } else {
            // Original behaviour: local zone
            year  = dt.getFullYear();
            month = dt.getMonth() + 1;   // JS months are 0-based
            day   = dt.getDate();
        }

        // Convert to YYYYMMDD integer
        return year * 10000 + month * 100 + day;
    }

    /**
     * Returns the local long timezone text.
     * For example "American/Chicago"
     *
     * @returns {string}
     */
    static getLocalTimezoneLongText() {
        return Intl.DateTimeFormat().resolvedOptions().timeZone;
    }

    /**
     * Returns the local short timezone text.
     * For example "CST"
     *
     * @returns {string}
     */
    static getLocalTimezoneShortText() {
        return new Date().toLocaleTimeString('en-us',{timeZoneName:'short'}).split(' ')[2];
    }

    /**
     * Add hours to a date.
     *
     * @param dt {Date|number|string}
     * @param hours {number}
     * @returns {Date}
     */
    static addHours(dt, hours) {
        if (typeof dt === 'string')
            dt = Number(dt);
        if (typeof dt === 'number')
            dt = new Date(dt);
        return new Date(dt.getTime() + hours * 60 * 60 * 1000);
    }

    /**
     * Add minutes to a date.
     *
     * @param dt {Date|number|string}
     * @param minutes {number}
     * @returns {Date}
     */
    static addMinutes(dt, minutes) {
        if (typeof dt === 'string')
            dt = Number(dt);
        if (typeof dt === 'number')
            dt = new Date(dt);
        return new Date(dt.getTime() + minutes * 60 * 1000);
    }

    /**
     * Combine a date and time into the number of milliseconds since 1970 UTC.
     * This is very valuable when trying to transit a DateTime to a backend without losing timezone info.
     *
     * @param date {number|Date} YYYYMMDD (time portion of a Date is not used)
     * @param time {number|null|undefined} HHMM
     * @returns {number}
     *
     * @see DateUtils.millsToInt()
     * @see TimeUtils.millsToInt()
     */
    static toMilliseconds(date, time) {
        let month = DateUtils.month(date)-1;
        if (month &lt; 0)
            month = 0;
        const dt = new Date(DateUtils.year(date), month, DateUtils.day(date), TimeUtils.hours(time), TimeUtils.minutes(time));
        const n = dt.valueOf();
        return n &lt; 0 ? 0 : n;
    }
}


</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
